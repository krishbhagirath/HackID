generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model analysis_results {
  id                                                        String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  org_id                                                    String
  event_id                                                  String
  submission_id_a                                           String?      @db.Uuid
  submission_id_b                                           String?      @db.Uuid
  method                                                    String
  version                                                   String
  score                                                     Decimal      @db.Decimal
  severity                                                  String?
  explanation                                               String?
  created_at                                                DateTime?    @default(now()) @db.Timestamptz(6)
  submissions_analysis_results_submission_id_aTosubmissions submissions? @relation("analysis_results_submission_id_aTosubmissions", fields: [submission_id_a], references: [id], onDelete: Cascade, onUpdate: NoAction)
  submissions_analysis_results_submission_id_bTosubmissions submissions? @relation("analysis_results_submission_id_bTosubmissions", fields: [submission_id_b], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model raw_submissions {
  submission_id String      @id @db.Uuid
  raw_json      Json
  scraped_at    DateTime?   @default(now()) @db.Timestamptz(6)
  submissions   submissions @relation(fields: [submission_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model submission_text {
  submission_id String      @db.Uuid
  section_key   String
  section_text  String
  submissions   submissions @relation(fields: [submission_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([submission_id, section_key])
}

model submissions {
  id                                                             String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  org_id                                                         String
  event_id                                                       String
  source                                                         String
  source_url                                                     String             @unique
  title                                                          String?
  tagline                                                        String?
  github_repo                                                    String?
  hackathon                                                      String?
  created_at                                                     DateTime?          @default(now()) @db.Timestamptz(6)
  updated_at                                                     DateTime?          @default(now()) @db.Timestamptz(6)
  analysis_results_analysis_results_submission_id_aTosubmissions analysis_results[] @relation("analysis_results_submission_id_aTosubmissions")
  analysis_results_analysis_results_submission_id_bTosubmissions analysis_results[] @relation("analysis_results_submission_id_bTosubmissions")
  raw_submissions                                                raw_submissions?
  submission_text                                                submission_text[]
}
